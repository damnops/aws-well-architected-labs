<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="A collection of AWS Well-Architected workshops"><link rel="canonical" href="http://wellarchitectedlabs.com/Reliability/300_Testing_for_Resiliency_of_EC2_RDS_and_S3/Lab_Guide.html"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Lab Guide - AWS Well-Architected Labs</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#757575">
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>


<link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="grey" data-md-color-accent="grey"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#level-300-performing-resiliency-testing-for-ec2-rds-and-s3" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="http://wellarchitectedlabs.com" title="AWS Well-Architected Labs" class="md-header-nav__button md-logo"><img src="../../images/wa.png" width="24" height="24"></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">AWS Well-Architected Labs</span><span class="md-header-nav__topic">Lab Guide</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/awslabs/aws-well-architected-labs/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">awslabs/aws-well-architected-labs</div></a></div></div></div></nav></header><div class="md-container"><nav class="md-tabs md-tabs--active" data-md-component="tabs"><div class="md-tabs__inner md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href="../../README.html" title="Home" class="md-tabs__link">Home</a></li><li class="md-tabs__item"><a href="../../Operations/README.html" title="Operational Excellence" class="md-tabs__link">Operational Excellence</a></li><li class="md-tabs__item"><a href="../../Security/README.html" title="Security" class="md-tabs__link">Security</a></li><li class="md-tabs__item"><a href="../README.html" title="Reliability" class="md-tabs__link md-tabs__link--active">Reliability</a></li><li class="md-tabs__item"><a href="../../Performance/README.html" title="Performance Efficiency" class="md-tabs__link">Performance Efficiency</a></li><li class="md-tabs__item"><a href="../../Cost/README.html" title="Cost Optimization" class="md-tabs__link">Cost Optimization</a></li><li class="md-tabs__item"><a href="../../Well-ArchitectedTool/README.html" title="Well Architected Tool" class="md-tabs__link">Well Architected Tool</a></li></ul></div></nav><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="http://wellarchitectedlabs.com" title="AWS Well-Architected Labs" class="md-nav__button md-logo"><img src="../../images/wa.png" width="48" height="48"></a>AWS Well-Architected Labs</label><div class="md-nav__source"><a href="https://github.com/awslabs/aws-well-architected-labs/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">awslabs/aws-well-architected-labs</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../README.html" title="Home" class="md-nav__link">Home</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"><label class="md-nav__link" for="nav-2">Operational Excellence</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">Operational Excellence</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Operations/README.html" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2"><label class="md-nav__link" for="nav-2-2">100 Inventory Patch Mgt</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-2-2">100 Inventory Patch Mgt</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Operations/100_Inventory_and_Patch_Mgmt/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Operations/100_Inventory_and_Patch_Mgmt/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"><label class="md-nav__link" for="nav-3">Security</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">Security</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Security/README.html" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2"><label class="md-nav__link" for="nav-3-2">Security 100 Labs</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-3-2">Security 100 Labs</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Security/100 - AWS Account & Root User/README.md" title="Account and Root User" class="md-nav__link">Account and Root User</a></li><li class="md-nav__item"><a href="../../Security/100 - Basic Identity & Access Management User, Group, Role/README.md" title="Basic Identity & Access Management User, Group, Role" class="md-nav__link">Basic Identity & Access Management User, Group, Role</a></li><li class="md-nav__item"><a href="../../Security/100 - CloudFront with S3 Bucket Origin/README.md" title="CloudFront with S3 Bucket Origin" class="md-nav__link">CloudFront with S3 Bucket Origin</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3"><label class="md-nav__link" for="nav-3-3">Security 200 Labs</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-3-3">Security 200 Labs</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Security/200 - Automated Deployment of Detective Controls/README.md" title="Automated Deployment of Detective Controls" class="md-nav__link">Automated Deployment of Detective Controls</a></li><li class="md-nav__item"><a href="../../Security/200 - Automated Deployment of EC2 Web Application/README.md" title="Automated Deployment of EC2 Web Application" class="md-nav__link">Automated Deployment of EC2 Web Application</a></li><li class="md-nav__item"><a href="../../Security/200 - Automated Deployment of IAM Groups and Roles/README.md" title="Automated Deployment of IAM Groups and Roles" class="md-nav__link">Automated Deployment of IAM Groups and Roles</a></li><li class="md-nav__item"><a href="../../Security/200 - Automated Deployment of VPC/README.md" title="Automated Deployment of VPC" class="md-nav__link">Automated Deployment of VPC</a></li><li class="md-nav__item"><a href="../../Security/200 - Basic EC2 with WAF Protection/README.md" title="Basic EC2 with WAF Protection" class="md-nav__link">Basic EC2 with WAF Protection</a></li><li class="md-nav__item"><a href="../../Security/200 - CloudFront with WAF Protection/README.md" title="CloudFront with WAF Protection" class="md-nav__link">CloudFront with WAF Protection</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4"><label class="md-nav__link" for="nav-3-4">Security 300 Labs</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-3-4">Security 300 Labs</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Security/300 - IAM Permission Boundaries Delegating Role Creation/README.md" title="IAM Permission Boundaries Delegating Role Creation" class="md-nav__link">IAM Permission Boundaries Delegating Role Creation</a></li><li class="md-nav__item"><a href="../../Security/300 - IAM Tag Based Access Control for EC2/README.md" title="IAM Tag Based Access Control for EC2" class="md-nav__link">IAM Tag Based Access Control for EC2</a></li><li class="md-nav__item"><a href="../../Security/300_Incident_Response_with_AWS_Console_and_CLI/README.html" title="Incident Response with AWS Console and CLI" class="md-nav__link">Incident Response with AWS Console and CLI</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5"><label class="md-nav__link" for="nav-3-5">Security Quests</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-3-5">Security Quests</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Security/Quest_100_Loft_Introduction_to_Security/README.html" title="Introduction to Security" class="md-nav__link">Introduction to Security</a></li><li class="md-nav__item"><a href="../../Security/Quest_100_Quick_Steps_to_Security_Success/README.html" title="Quick Steps to Security Success" class="md-nav__link">Quick Steps to Security Success</a></li><li class="md-nav__item"><a href="../../Security/Quest_300_Security_Best_Practices_Workshop_EC2/README.html" title="Security Best Practices Workshop" class="md-nav__link">Security Best Practices Workshop</a></li><li class="md-nav__item"><a href="../../Security/Quest_300_Security_Best_Practices_Day/README.html" title="Security Best Practices Day" class="md-nav__link">Security Best Practices Day</a></li><li class="md-nav__item"><a href="../../Security/Quest_Identity_Access_Management/README.html" title="Identity & Access Management" class="md-nav__link">Identity & Access Management</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked><label class="md-nav__link" for="nav-4">Reliability</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Reliability</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../README.html" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked><label class="md-nav__link" for="nav-4-2">Testing Resiliency</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-2">Testing Resiliency</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-1" type="checkbox" id="nav-4-2-1"><label class="md-nav__link" for="nav-4-2-1">200 EC2 Resiliency</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-2-1">200 EC2 Resiliency</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../200_Testing_for_Resiliency_of_EC2/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../200_Testing_for_Resiliency_of_EC2/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2" checked><label class="md-nav__link" for="nav-4-2-2">300 EC2, RDS S3 Resiliency</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-2-2">300 EC2, RDS S3 Resiliency</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Lab Guide</label><a href="Lab_Guide.html" title="Lab Guide" class="md-nav__link md-nav__link--active">Lab Guide</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#authors" title="Authors" class="md-nav__link">Authors</a></li></ul></nav></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"><label class="md-nav__link" for="nav-5">Performance Efficiency</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">Performance Efficiency</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Performance/README.html" title="Coming Soon" class="md-nav__link">Coming Soon</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"><label class="md-nav__link" for="nav-6">Cost Optimization</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">Cost Optimization</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/README.html" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2"><label class="md-nav__link" for="nav-6-2">Cost Optimization Fundamentals</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-2">Cost Optimization Fundamentals</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/README.html" title="Fundamentals Overview" class="md-nav__link">Fundamentals Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-2" type="checkbox" id="nav-6-2-2"><label class="md-nav__link" for="nav-6-2-2">100 Account Setup</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-2">100 Account Setup</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_1_AWS_Account_Setup/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_1_AWS_Account_Setup/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-3" type="checkbox" id="nav-6-2-3"><label class="md-nav__link" for="nav-6-2-3">100 Governance</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-3">100 Governance</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_2_Cost_and_Usage_Governance/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_2_Cost_and_Usage_Governance/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-4" type="checkbox" id="nav-6-2-4"><label class="md-nav__link" for="nav-6-2-4">100 Analysis</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-4">100 Analysis</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_4_Cost_and_Usage_Analysis/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_4_Cost_and_Usage_Analysis/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-5" type="checkbox" id="nav-6-2-5"><label class="md-nav__link" for="nav-6-2-5">100 Visualization</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-5">100 Visualization</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_5_Cost_Visualization/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/100_5_Cost_Visualization/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-6" type="checkbox" id="nav-6-2-6"><label class="md-nav__link" for="nav-6-2-6">200 Governance</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-6">200 Governance</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_2_Cost_and_Usage_Governance/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_2_Cost_and_Usage_Governance/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-7" type="checkbox" id="nav-6-2-7"><label class="md-nav__link" for="nav-6-2-7">200 Pricing Models</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-7">200 Pricing Models</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_3_Pricing_Models/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_3_Pricing_Models/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-8" type="checkbox" id="nav-6-2-8"><label class="md-nav__link" for="nav-6-2-8">200 Analysis</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-8">200 Analysis</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_4_Cost_and_Usage_Analysis/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_4_Cost_and_Usage_Analysis/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-9" type="checkbox" id="nav-6-2-9"><label class="md-nav__link" for="nav-6-2-9">200 Visualization</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-2-9">200 Visualization</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_5_Cost_Visualization/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_Fundamentals/200_5_Cost_Visualization/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3"><label class="md-nav__link" for="nav-6-3">Cost and Usage Analysis</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-3">Cost and Usage Analysis</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/README.html" title="Analysis Overview" class="md-nav__link">Analysis Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3-2" type="checkbox" id="nav-6-3-2"><label class="md-nav__link" for="nav-6-3-2">300 Automated CUR Updates and Ingestion</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-3-2">300 Automated CUR Updates and Ingestion</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/300_Automated_CUR_Updates_and_Ingestion/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/300_Automated_CUR_Updates_and_Ingestion/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3-3" type="checkbox" id="nav-6-3-3"><label class="md-nav__link" for="nav-6-3-3">300 Multi Account CUR Access</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-3-3">300 Multi Account CUR Access</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/300_Multi_Account_CUR_Access/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/300_Multi_Account_CUR_Access/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3-4" type="checkbox" id="nav-6-3-4"><label class="md-nav__link" for="nav-6-3-4">300 Splitting Sharing CUR</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-6-3-4">300 Splitting Sharing CUR</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/300_Splitting_Sharing_CUR_Access/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Cost/Cost_and_Usage_Analysis/300_Splitting_Sharing_CUR_Access/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7"><label class="md-nav__link" for="nav-7">Well Architected Tool</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-7">Well Architected Tool</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Well-ArchitectedTool/README.html" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2"><label class="md-nav__link" for="nav-7-2">Walkthrough</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-2">Walkthrough</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../Well-ArchitectedTool/100_Walkthrough_of_the_Well-Architected_Tool/README.html" title="Lab Overview" class="md-nav__link">Lab Overview</a></li><li class="md-nav__item"><a href="../../Well-ArchitectedTool/100_Walkthrough_of_the_Well-Architected_Tool/Lab_Guide.html" title="Lab Guide" class="md-nav__link">Lab Guide</a></li></ul></nav></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#authors" title="Authors" class="md-nav__link">Authors</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/awslabs/aws-well-architected-labs/edit/master/docs/Reliability/300_Testing_for_Resiliency_of_EC2_RDS_and_S3/Lab_Guide.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1 id="level-300-performing-resiliency-testing-for-ec2-rds-and-s3">Level 300: Performing Resiliency Testing for EC2, RDS, and S3</h1>
<h2 id="authors">Authors</h2>
<ul>
<li>Rodney Lester, Reliability Lead, Well-Architected, AWS</li>
</ul>
<h1 id="table-of-contents">Table of Contents</h1>
<ol>
<li><a href="#deploy_infra">Deploying the infrastructure</a></li>
<li><a href="#failure_scenarios">Discussion and Example Failure Scenarios</a></li>
<li><a href="#failure_modes">Failure modes</a></li>
<li><a href="#tear_down">Tear Down</a></li>
</ol>
<h2 id="1-deploying-the-infrastructure">1. Deploying the infrastructure <a name="deploy_infra"></a></h2>
<p>AWS requires “Service-Linked” Roles for AWS Auto Scaling, Elastic Load Balancing, and Amazon RDS to create the services and metrics they manage. In the past, these Roles may have been created automatically for you, or we may need to create them. Here is how to find which roles you need to create.  </p>
<h3 id="11-checking-for-existing-service-linked-roles">1.1 Checking for Existing Service-Linked Roles</h3>
<ol>
<li>Sign in to the AWS Management Console as an IAM user with MFA enabled or in a federated Role, and open the IAM console at <a href="https://console.aws.amazon.com/iam/">https://console.aws.amazon.com/iam/</a>.</li>
<li>In the navigation pane, click <strong>Roles</strong>.<br />
<img alt="SelectIAMRoles" src="Images/SelectIAMRoles.png" />  </li>
<li>In the filter box, type “Service” to find the service linked roles that exist in your account and look for “AutoScaling,” “ELB” or “ElasticLoadBalancing,” and “RDS.” In this screenshot, the service linked role for AutoScaling exists, but the roles for ELB and RDS do not. Note which roles will need to be created as you will use this information when performing the next step.<br />
<img alt="LookingForServiceLinkedRoles" src="Images/LookingForServiceLinkedRoles.png" />  </li>
<li>In the AWS Services Search Box, type “CloudFormation” and click enter.  </li>
<li>You will need to download the CloudFormation template that will deploy the lambda functions and step functions state machine. Change the region to <strong>Ohio</strong> and navigate to the CloudFormation console.<br />
<img alt="SelectOhio" src="Images/SelectOhio.png" />  </li>
<li>On the CloudFormation console, click “Create Stack:”.<br />
<img alt="Images/CreateStackButton" src="Images/CreateStackButton.png" />  </li>
<li>There are two versions that can be deployed. You can deploy in one AWS region, which will allow you start testing sooner, or you can deploy into 2 AWS regions, which will enable you to test some additional aspects of S3, as well as as simulation a regional failure of your application<ol>
<li>For a single region deployment, select the option to “Specify an Amazon S3 template" and enter <strong>https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/lambda_functions_for_deploy.json</strong><br />
<img alt="LambdaCFNEntered-ohio" src="Images/LambdaCFNEntered-ohio.png" /></li>
<li>For a two region deployment, select the option to “Specify an Amazon S3 template" and enter <strong>https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/lambda_functions_for_deploy_two_regions.json</strong><br />
<img alt="LambdaCFNEntered-tworegion" src="Images/LambdaCFNEntered-tworegion.png" /></li>
</ol>
</li>
<li>Click the “Next” button. On this page you will enter the following information:<ol>
<li>For the single region deployment:</li>
</ol>
</li>
<li>Stack name: “DeployResiliencyWorkshop” &lt;-No spaces!</li>
<li>EnableAutoScalingServiceRole: “false” or “true,” depending on whether it exists. In the example, this will be false since it already exists.</li>
<li>EnableELBServiceRole: “false” or “true,” depending on whether it exists. In the example, this will be true because it does not exist.</li>
<li>EnableRDSServiceRole: “false” or “true,” depending on whether it exists. In the example, this will be true because it does not exist.</li>
<li>LambdaFunctionsBucket: “aws-well-architected-labs-ohio” &lt;-Case sensitive!</li>
<li>RDSLambdaKey: “Reliability/RDSLambda.zip” &lt;-Case sensitive!</li>
<li>VPCLambdaKey: “Reliability/VPCLambda.zip” &lt;-Case sensitive!</li>
<li>WaitForStackLambdaKey: “Reliability/WaitForStack.zip” &lt;-Case sensitive!</li>
<li>WebAppLambdaKey: “Reliability/WebAppLambda.zip” &lt;-Case sensitive!
<img alt="CFNParameters-ohio" src="Images/CFNParameters-ohio.png" /><ol>
<li>For the two region deployment:</li>
</ol>
</li>
<li>Stack name: “DeployResiliencyWorkshop” &lt;-No spaces!</li>
<li>DMSLambdaKey: “Reliability/DMSLambda.zip” &lt;-Case sensitive!</li>
<li>EnableAutoScalingServiceRole: “false” or “true,” depending on whether it exists. In the example, this will be false since it already exists.</li>
<li>EnableELBServiceRole: “false” or “true,” depending on whether it exists. In the example, this will be true because it does not exist.</li>
<li>EnableRDSServiceRole: “false” or “true,” depending on whether it exists. In the example, this will be true because it does not exist.</li>
<li>LambdaFunctionsBucket: “aws-well-architected-labs-ohio” &lt;-Case sensitive!</li>
<li>RDSLambdaKey: “Reliability/RDSLambda.zip” &lt;-Case sensitive!</li>
<li>RDSRRLambdaKey: "Reliability/RDSReadReplicaLambda.zip" &lt;-Case sensitive!</li>
<li>VPCLambdaKey: “Reliability/VPCLambda.zip” &lt;-Case sensitive!</li>
<li>WaitForStackLambdaKey: “Reliability/WaitForStack.zip” &lt;-Case sensitive!</li>
<li>WebAppLambdaKey: “Reliability/WebAppLambda.zip” &lt;-Case sensitive!
<img alt="CFNParameters-2Region" src="Images/CFNParameters-2Region.png" />  </li>
<li>Click the “Next” button. On the “Options” page, click the “Next” button at the bottom of the page. On the “Review” page, scroll to the bottom and select the option “I acknowledge that AWS CloudFormation might create IAM resources.” Click the “Create” button. This will take you to the summary with the stack creation in progress.<br />
<img alt="StackCreationStarted" src="Images/StackCreationStarted.png" />  </li>
<li>This will take approximately a minute to deploy. You now need to navigate to the Step Functions console. At the top of the window, click the downward facing icon to the right of the word “Services.” This will bring up the list of services. Type “Step Functions” in the search box and press the enter key.<br />
<img alt="EnteringStepFunctions" src="Images/EnteringStepFunctions.png" />  </li>
<li>On the Step Functions dashboard, you will see “State Machines” and you will have a new one named “DeploymentMachine-<random characters>.” Click on that state machine. This will bring up an execution console. Click on the “Start execution” button.<br />
<img alt="DeploymentMachine" src="Images/DeploymentMachine.png" />  </li>
<li>For input to the execution name, use “BuildResiliency.”<ol>
<li>One Region Deployment:<ol>
<li>For Input, use the following:
<strong>Note:</strong> If you want to test failure of S3, then you should use an image in S3 that you control, and it should have public read access only.</li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>{
  &quot;log_level&quot;: &quot;DEBUG&quot;,
  &quot;region_name&quot;: &quot;us-east-2&quot;,
  &quot;secondary_region_name&quot;: &quot;us-west-2&quot;,
  &quot;cfn_region&quot;: &quot;us-east-2&quot;,
  &quot;cfn_bucket&quot;: &quot;aws-well-architected-labs-ohio&quot;,
  &quot;folder&quot;: &quot;Reliability/&quot;,
  &quot;workshop&quot;: &quot;300-ResiliencyofEC2RDSandS3&quot;,
  &quot;boot_bucket&quot;: &quot;aws-well-architected-labs-ohio&quot;,
  &quot;boot_prefix&quot;: &quot;Reliability/&quot;,
  &quot;boot_object&quot;: &quot;bootstrap300Resiliency.sh&quot;,
  &quot;websiteimage&quot; : &quot;https://s3.us-east-2.amazonaws.com/arc327-well-architected-for-reliability/Cirque_of_the_Towers.jpg&quot;
}
</code></pre>

<pre><code>    b. Then click the “Start Execution” button.
</code></pre>
<p><img alt="ExecutionInput-ohio" src="Images/ExecutionInput-ohio.png" /><br />
    ii. Two Region Deployment:
        a. For Input, use the following:
        <strong>Note:</strong> If you want to test failure of S3, then you should use an image in S3 that you control, and it should have public read access only.</p>
<pre><code>{
  &quot;region1&quot;: {
    &quot;log_level&quot;: &quot;DEBUG&quot;,
    &quot;region_name&quot;: &quot;us-east-2&quot;,
    &quot;secondary_region_name&quot;: &quot;us-west-2&quot;,
    &quot;cfn_region&quot;: &quot;us-east-2&quot;,
    &quot;cfn_bucket&quot;: &quot;aws-well-architected-labs-ohio&quot;,
    &quot;folder&quot;: &quot;Reliability/&quot;,
    &quot;workshop&quot;: &quot;300-ResiliencyofEC2RDSandS3&quot;,
    &quot;boot_bucket&quot;: &quot;aws-well-architected-labs-ohio&quot;,
    &quot;boot_prefix&quot;: &quot;Reliability/&quot;,
    &quot;boot_object&quot;: &quot;bootstrap300Resiliency.sh&quot;,
    &quot;websiteimage&quot; : &quot;https://s3.us-east-2.amazonaws.com/arc327-well-architected-for-reliability/Cirque_of_the_Towers.jpg&quot;
  },
  &quot;region2&quot;: {
    &quot;log_level&quot;: &quot;DEBUG&quot;,
    &quot;region_name&quot;: &quot;us-west-2&quot;,
    &quot;secondary_region_name&quot;: &quot;us-east-2&quot;,
    &quot;cfn_region&quot;: &quot;us-east-2&quot;,
    &quot;cfn_bucket&quot;: &quot;aws-well-architected-labs-ohio&quot;,
    &quot;folder&quot;: &quot;Reliability/&quot;,
    &quot;workshop&quot;: &quot;300-ResiliencyofEC2RDSandS3&quot;,
    &quot;boot_bucket&quot;: &quot;aws-well-architected-labs-ohio&quot;,
    &quot;boot_prefix&quot;: &quot;Reliability/&quot;,
    &quot;boot_object&quot;: &quot;bootstrap300Resiliency.sh&quot;,
    &quot;websiteimage&quot; : &quot;https://s3.us-east-2.amazonaws.com/arc327-well-architected-for-reliability/Cirque_of_the_Towers.jpg&quot;
  }
}
</code></pre>

<pre><code>    b. Then click the “Start Execution” button.
</code></pre>
<p><img alt="ExecutionInput-2Regions" src="Images/ExecutionInput-2Regions.png" /><br />
14. This will take approximately 20-25 minutes for one region to deploy and approximately 45-50 minutes for two regions to deploy. You will have enough to start executing the lab exercises for the two region in 25-30 minutes. You can watch the state machine as it executes by clicking the icon to expand the visual workflow to the full screen.<br />
    1. One Region:
<img alt="StateMachineExecuting" src="Images/StateMachineExecuting.png" />
    1. Two Regions:
<img alt="StateMachineExecuting-2Regions" src="Images/StateMachineExecuting-2Regions.png" /><br />
15. You can also watch the CloudFormation stacks as they are created. If you are in a workshop, the instructor will have some background information to share while this is created. You can resume testing when the web tier has been deployed in the Ohio region. This will look something like this on the visual workflow.<br />
<img alt="StepFunctionWebAppDeployed" src="Images/StepFunctionWebAppDeployed.png" /><br />
16. You can start testing:
    1. When the WaitForWebApp step for a single region deployment is completed, return to the CloudFormation console and select the “WebServersforResiliencyTesting” stack and then the Outputs tab at bottom.<br />
<img alt="CFNComplete" src="Images/CFNComplete.png" />
    1. When the WaitForWebApp1 step for a two region deployment is completed, return to the CloudFormation console and select the “WebServersforResiliencyTesting” stack and then the Outputs tab at bottom.
<img alt="CFNReadyForTesting" src="Images/CFNReadyForTesting.png" />
17. Click the value and it will bring up the website:<br />
<img alt="DemoWebsite" src="Images/DemoWebsite.png" /></p>
<h2 id="2-discussion-and-example-failure-scenarios">2. Discussion and Example Failure Scenarios <a name="failure_scenarios"></a></h2>
<p>There is a choice of environments to execute the failure simulations in. Linux command line (bash), Python, Java, and C#.  The instructions for each environment are in separate sections.</p>
<h3 id="21-setting-up-the-bash-environment">2.1 Setting Up the bash Environment</h3>
<p>All the command line scripts use a utility called jq. You can download it from the site and leave it in your local directory, as long as that is in your execution path:<br />
<a href="https://stedolan.github.io/jq/">https://stedolan.github.io/jq/</a><br />
1. You can find out what your execution path is with the following command.</p>
<pre><code>$ echo $PATH
/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/opt/aws/bin:/home/ec2-user/.local/bin:/home/ec2-user/bin
</code></pre>

<ol>
<li>If you have sudo rights, then copy the executable to /usr/local/bin/jq and make it executable.  </li>
</ol>
<pre><code>$ sudo cp jq-linux64 /usr/local/bin/jq
$ sudo chmod 755 /usr/local/bin/jq
</code></pre>

<ol>
<li>If you do not have sudo rights, then copy it into your home directory under a /bin directory. In Amazon linux, this is typically /home/ec2-user/bin.  </li>
</ol>
<pre><code>$ cp jq-linux64 ~/bin/jq
$ chmod 755 ~/bin/jq
</code></pre>

<ol>
<li>Install the AWS Command Line Interface (CLI) if you do not have it installed (it is installed by default on Amazon Linux).<br />
<a href="https://aws.amazon.com/cli/">https://aws.amazon.com/cli/</a></li>
<li>Run the aws configure command to configure your command line options. This will prompt you for the AWS Access Key ID, AWS Secret Access Key, and default region name. Enter the key information if you do not already have them installed, and set the default region to “us-east-2” and leave the default output format as “None.”.  </li>
</ol>
<pre><code>$ aws configure
AWS Access Key ID [*************xxxx]: &lt;Your AWS Access Key ID&gt;
AWS Secret Access Key [**************xxxx]: &lt;Your AWS Secret Access Key&gt;
Default region name: [us-east-2]: us-east-2
Default output format [None]:&lt;return&gt;
</code></pre>

<ol>
<li>Download the zip file of the resiliency bash scripts at the following URL:<br />
<a href="https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/bashresiliency.zip">https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/bashresiliency.zip</a></li>
<li>Unzip the folder in a location convenient for you to execute the scripts.  </li>
<li>They are also available in the <a href="Code/FailureSimulations/Bash/">Code/FailureSimulations/bash/</a> directory.</li>
</ol>
<h3 id="22-setting-up-a-programming-language-based-environment">2.2 Setting up a Programming Language Based Environment</h3>
<p>You will need the same files that the AWS command line uses for credentials. You can either install the command line and use the ‘aws configure’ command as outlined in the bash set up, or you can manually create the configuration files. To create the files manually, create a .aws folder/directory in your home directory.<br />
1. Bash and powershell use the same command.  </p>
<pre><code>mkdir ~/.aws
</code></pre>

<ol>
<li>Change directory to that directory to create the configuration file.<br />
Bash</li>
</ol>
<pre><code>cd ~/.aws
</code></pre>

<p>Powershell</p>
<pre><code>cd ~\.aws
</code></pre>

<ol>
<li>Use a text editor (vim, emacs, notepad, wordpad) to create a text file (no extension named “credentials.” In this file you should have the following text.  </li>
</ol>
<pre><code>[default]
aws_access_key_id = &lt;Your access key&gt;
aws_secret_access_key = &lt;Your secret key&gt;
region = us-east-2
</code></pre>

<h3 id="23-setting-up-the-python-environment">2.3 Setting Up the Python Environment</h3>
<ol>
<li>The scripts are written in python with boto3. On Amazon Linux, this is already installed. Use your local operating system instructions to install boto3: <a href="https://github.com/boto/boto3">https://github.com/boto/boto3</a></li>
<li>Download the zip file of the resiliency scripts at the following URL.<a href="https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/pythonresiliency.zip">https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/pythonresiliency.zip</a>   </li>
<li>Unzip the folder in a location convenient for you to execute the scripts.  </li>
</ol>
<h3 id="24-setting-up-the-java-environment">2.4 Setting Up the Java Environment</h3>
<ol>
<li>The command line utility in Java requires Java 8 SE. In Amazon Linux, you need to install Java 8 and remove Java 7.  </li>
</ol>
<pre><code>$ sudo yum install java-1.8.0-openjdk
$ sudo yum remove java-1.7.0-openjdk
</code></pre>

<ol>
<li>Download the zipfile of the executables at the following URL <a href="https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/javaresiliency.zip">https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/javaresiliency.zip</a>.   </li>
<li>Unzip the folder in a location convenient for you to execute the command line programs.  </li>
</ol>
<h3 id="25-setting-up-the-c-environment">2.5 Setting Up the C# Environment</h3>
<ol>
<li>Download the zipfile of the executables at the following URL. <a href="https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/csharpresiliency.zip">https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/csharpresiliency.zip</a>  </li>
<li>Unzip the folder in a location convenient for you to execute the command line programs.  </li>
</ol>
<h3 id="26-setting-up-the-powershell-environment">2.6 Setting up the Powershell Environment</h3>
<ol>
<li>If you do not have the AWS Tools for Powershell, download and install them following the instructions here. <a href="https://aws.amazon.com/powershell/">https://aws.amazon.com/powershell/</a>  </li>
<li>Follow the “Getting Started” instructions for configuring credentials. <a href="https://docs.aws.amazon.com/powershell/latest/userguide/pstools-getting-started.html">https://docs.aws.amazon.com/powershell/latest/userguide/pstools-getting-started.html</a>  </li>
<li>Download the zipfile of the scripts at the following URL. <a href="https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/powershellresiliency.zip">https://s3.us-east-2.amazonaws.com/aws-well-architected-labs-ohio/Reliability/powershellresiliency.zip</a>  </li>
<li>Unzip the folder in a location convenient for you to execute the scripts.</li>
</ol>
<h2 id="3-failure-modes">3. Failure modes <a name="failure_modes"></a></h2>
<h3 id="31-ec2-failure-mode">3.1 EC2 Failure Mode</h3>
<ol>
<li>The first failure mode will be to fail a web server. To prepare for this, you should have two consoles open: VPC and EC2. From the AWS Console, click the downward facing icon to the right of the word “Services.” This will bring up the list of services. Type “EC2” in the search box and press the enter key.<br />
<img alt="EnteringEC2" src="Images/EnteringEC2.png" />  </li>
<li>You also need the VPC Console. From the AWS Console, click the downward facing icon to the right of the word “Services.” This will bring up the list of services. Type “VPC” in the search box, then right click on the “VPC Isolate Cloud Resources” text and open the link in a new tab or window. You can then click the upward facing icon to the right of the word “Services” to make the menu of services disappear.<br />
<img alt="EnteringVPC" src="Images/EnteringVPC.png" />  </li>
<li>On the EC2 Console, click “Instances” on the left side to bring up the list of instances.<br />
<img alt="SelectingInstances" src="Images/SelectingInstances.png" />  </li>
<li>Use this as the command line argument to the scripts/programs below.  </li>
<li>Instance Failure in bash
Execute the failure mode script for failing an instance:</li>
</ol>
<pre><code>$./fail_instance.sh &lt;vpc-id&gt;
</code></pre>

<ul>
<li>Instance Failure in Python: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ python fail_instance.py &lt;vpc-id&gt;
</code></pre>

<ul>
<li>Instance Failure in Java: Execute the failure mode program for failing an instance:</li>
</ul>
<pre><code>$ java -jar app-resiliency-1.0.jar EC2 &lt;vpc-id&gt;
</code></pre>

<ul>
<li>Instance Failure in C#: Execute the failure mode program for failing an instance:</li>
</ul>
<pre><code>$ .\AppResiliency EC2 &lt;vpc-id&gt;
</code></pre>

<ul>
<li>Instance Failure in Powershell: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ .\fail_instance.ps1 &lt;vpc-id&gt;
</code></pre>

<ol>
<li>Watch the behavior of the Load Balancer Target Group and its Targets in the EC2 Console. See it get marked unhealthy and replaced by the Auto Scaling Group.<br />
<img alt="TargetGroups" src="Images/TargetGroups.png" />  </li>
</ol>
<h3 id="32-rds-failure-mode">3.2 RDS Failure Mode</h3>
<ol>
<li>From the AWS EC2 Console (you will still need the VPC ID from the VPC Console), click the downward facing icon to the right of the word “Services.” This will bring up the list of services. Type “RDS” in the search box and press the enter key.<br />
<img alt="SelectingRDS" src="Images/SelectingRDS.png" />  </li>
<li>Use this as the command line argument to the scripts/programs below.  </li>
<li>RDS Instance Failure in bash: Execute the failure mode script for failing over an RDS instance:</li>
</ol>
<pre><code>$./failover_rds.sh &lt;vpc-id&gt;
</code></pre>

<ul>
<li>RDS Instance Failure in Python: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ python fail_rds.py &lt;vpc-id&gt;
</code></pre>

<ul>
<li>RDS Instance Failure in Java: Execute the failure mode program for failing an instance:</li>
</ul>
<pre><code>$ java -jar app-resiliency-1.0.jar RDS &lt;vpc-id&gt;
</code></pre>

<ul>
<li>RDS Instance Failure in C#: Execute the failure mode program for failing an instance:</li>
</ul>
<pre><code>$ .\AppResiliency RDS &lt;vpc-id&gt;
</code></pre>

<ul>
<li>RDS Instance Failure in Powershell: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ .\failover_rds.ps1 &lt;vpc-id&gt;
</code></pre>

<p>Watch the behavior of the website. What happens? 
Watch the EC2 Load Balancer Target Group and its Targets’ health. Do the instances recover?</p>
<h3 id="33-az-failure">3.3 AZ Failure</h3>
<ol>
<li>Availability zone failure.</li>
<li>AZ Failure in bash: Execute the following script for failing over an Availability Zone:</li>
</ol>
<pre><code>$./fail_az.sh &lt;az&gt; &lt;vpc-id&gt;
</code></pre>

<ul>
<li>AZ Failure in Python: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ python fail_az.py &lt;vpc-id&gt; &lt;az&gt;
</code></pre>

<ul>
<li>AZ Failure in Java: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ java -jar app-resiliency-1.0.jar AZ &lt;vpc-id&gt; &lt;az&gt;
</code></pre>

<ul>
<li>AZ Failure in C#: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ .\AppResiliency AZ &lt;vpc-id&gt; &lt;az&gt;
</code></pre>

<ul>
<li>AZ Failure in Powershell: Execute the failure mode script for failing an instance:</li>
</ul>
<pre><code>$ .\fail_az.ps1 &lt;az&gt; &lt;vpc-id&gt;
</code></pre>

<p>What is the expected effect? How long does it take to take effect? Look at the Target Group Targets to see them go unhealthy, also watch the EC2 instances to see the one in the target AZ shutdown and be restarted in one of the other AZs.
What would you do if the ASG was only in one AZ? You could call the AutoScaling SuspendProcesses and then get the list of instances in the group and call EC2 StopInstances or TerminateInstances
How would you undo all these changes?</p>
<h3 id="34-failure-of-s3">3.4 Failure of S3</h3>
<ol>
<li>Failure of S3 means that the image will not be available.</li>
<li>Failure in bash: The bash commands available do not allow for modification of the access permissions, so you'll have to do the work in the console.</li>
<li>Navigate to the S3 console: [https://s3.console.aws.amazon.com/s3/home](https://s3.console.aws.amazon.com/s3/home]</li>
<li>Select the bucket where the image is located. In my example, this is the bucket "arc327-well-architected-for-reliability"</li>
<li>Select the object, then select the "Permissions" tab:</li>
<li>Select the "Public Access" radio button, and deselect the "Read object" box:</li>
</ol>
<p>What is the expected effect? How long does it take to take effect? How would you diagnose if this is a larger problem than permissions?</p>
<h3 id="35-looking-for-more-to-do">3.5 Looking for more to do?</h3>
<p>You can use drift detection in the CloudFormation console to see what had changed, or work on code to heal their failure modes.<br />
1. Remove the network ACLs they added<br />
2. Reconfigure the AutoScaling Groups to use the AZ  </p>
<hr />
<h2 id="4-tear-down-this-lab">4. Tear down this lab <a name="tear_down"></a></h2>
<p>In order to take down the lab environment, you will need to remove the association of the Network ACL that was added to fail the AZ, and delete the Network ACL in the console. You can then delete the CloudFormation stacks (in both AWS regions) that were created. Here are the instructions for how to do that.
1. Navigate to the VPC Console. From the AWS Console, click the downward facing icon to the right of the word “Services.” This will bring up the list of services. Type “VPC” in the search box, then press enter.<br />
<img alt="EnteringVPC" src="Images/EnteringVPC.png" />  </p>
<ol>
<li>On the VPC Console, click on Network ACLs and select the Network ACL that is associated with 4 subnets in the ResiliencyVPC. Click the “Subnet Associations” tab and then Click the “Edit button.<br />
<img alt="SelectingNACL" src="Images/SelectingNACL.png" />  </li>
<li>You need to associate the 2 subnets that were changed to the blocking Network ACL back to this default Network ACL. Select the 2 subnets available, then click the “Save” button.<br />
<img alt="AssociatingNACL" src="Images/AssociatingNACL.png" />  </li>
<li>Now select the Network ACL that is associated with 0 Subnets and click the “Delete” button to delete this Network ACL.<br />
<img alt="DeletingNACL" src="Images/DeletingNACL.png" />  </li>
<li>If you have deployed into 2 regions, you have to delete the Database Migration Service and RDS Read Replicas before you can delete the RDS instances.  You can delete the DMS (in Oregon) and read replica at the same time, but the console only allows you to select one of the stacks at a time. Select the “DMSforResiliencyTesting” stack, then click the “Actions” button, and click “DeleteStack:”.<br />
<img alt="DeletingDMS" src="Images/DeletingDMS.png" />  </li>
<li>You can then select the “ MySQLReadReplicaResiliencyTesting” stack, click the “Actions” button, and click “Delete Stack” to simultaneously delete the RDS Read Replica instance.<br />
<img alt="DeletingRDSReadReplica" src="Images/DeletingRDSReadReplica.png" />  </li>
<li>If you have deployed in 2 regions, Navigate to the other region (Ohio, if you started in Oregon, and Oregon, if you started in Ohio), and perform the same deletion steps above for the RDS read replica and DMS, if in Oregon. Wait for the read replicas to be deleted. You can delete the web servers and RDS at the same time, but the console only allows you to select one of the stacks at a time. Select the “WebServersforResiliencyTesting” stack, then click the “Actions” button, and click “Delete Stack:”.<br />
<img alt="DeletingWebServers" src="Images/DeletingWebServers.png" />  </li>
<li>You can then select the “ MySQLforResiliencyTesting” stack, click the “Actions” button, and click “Delete Stack” to simultaneously delete the RDS instance.<br />
<img alt="DeleteRDS" src="Images/DeleteRDS.png" />  </li>
<li>You can then select the “DeployResiliencyWorkshop” stack, click the “Actions” button, and click “Delete Stack” to simultaneously delete the deployment machine and Lambda functions.<br />
<img alt="DeletingLambdaandStepFunctions" src="Images/DeletingLambdaandStepFunctions.png" />  </li>
<li>Once all these stacks have deleted, you can then select the “ResiliencyVPC” stack, click the “Actions” button, and click “Delete Stack” to delete the VPC and remove the last piece of infrastructure.<br />
<img alt="DeletingVPC" src="Images/DeletingVPC.png" />  </li>
<li>When it is delete complete, you are done.  </li>
</ol>
<hr />
<h2 id="references-useful-resources">References &amp; useful resources:</h2>
<hr />
<h2 id="license">License</h2>
<h3 id="documentation-license">Documentation License</h3>
<p>Licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Share Alike 4.0</a> license.</p>
<h3 id="code-license">Code License</h3>
<p>Licensed under the Apache 2.0 and MITnoAttr License. </p>
<p>Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance with the License. A copy of the License is located at</p>
<pre><code>http://aws.amazon.com/apache2.0/
</code></pre>
<p>or in the "license" file accompanying this file. This file is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="README.html" title="Lab Overview" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Lab Overview</span></div></a><a href="../../Performance/README.html" title="Coming Soon" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Coming Soon</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">&copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script></body></html>